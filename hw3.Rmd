---
title: "HW3"
author: Deepika Dilip, Tora Mullings, Daniel Sullivan, Deepa Sharma, Bikram Barua,
  Newman Okereafor
date: '2022-10-19'
output:
  html_document: default
---

# Data Exploration

```{r, echo = F, warning = F, message = F}
library(tidyverse)
library(ggplot2)
library(ggthemes)
library(corrplot)
library(reshape2)
library(knitr)
library(broom)
library(caret)
library(leaps)
```

## Correlation Plot
```{r, echo = F, warning = F, message = F}
crime.train = read.csv('https://raw.githubusercontent.com/djunga/DATA621HW3/deepika/crime_train.csv')
corrplot(corr = cor(crime.train), tl.col="black", tl.cex=0.6, order='AOE')

```

*Interpretation*: `tax` and `rad` are highliy correlated variables. Meanwhile `dis` is inversely correlated with `indus`, `nox`, and `age`.

## Distribution Visualization
```{r, echo = F, warning = F, message = F}
mlt.train = crime.train
mlt.train$ID = rownames(mlt.train)
mlt.train = melt(mlt.train, id.vars = "ID")
ggplot(aes(value), data = mlt.train) + geom_histogram() + facet_wrap(~variable, scales = "free") + labs(title = "Distributions of Predictors", x = "Predictors")
```

*Interpretation*: `target` is a binary variable (outcome). Age is skewed to the left. `rm` is normally distributed. `tax` and `rad` have a couple of outliers but its lower quadrant maintains a normal distribution. 



## Building models

### Model 1: all predictors
```{r}
lmod <- glm(target ~ ., family = binomial, crime.train)
```

### Model 2: Backward Elimination
```{r}
train.control <- trainControl(method="cv", number=10)   # k-fold cross-validation
step.model <- train(target ~., data=crime.train, method="leapBackward", tuneGrid=data.frame(nvmax=1:12), trControl=train.control)
step.model$results
```
The model with 4 predictors has the lowest RSME value. It also has the highest R-squared.
```{r}
summary(step.model$finalModel)
```

```{r}
coef(step.model$finalModel, 4)
```

```{r}
lmod1 <- glm(target ~ nox + age + rad + medv, family = binomial, crime.train)
lmod1
```
